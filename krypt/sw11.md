# Public Key Infrastrukturen (PKI)

## Repeition asymmetrische VerschlÃ¼sselung & digitale Signaturen

ğŸ¯ Sie kennen die Mechanismen, die PKI-Verfahren zugrunde liegen (verschlÃ¼sseln, signieren)

Asymmetrische VerschlÃ¼sselung:

* Unterschiedliche SchlÃ¼ssel: Public & Private Key
* Algorithmen: RSA, elliptische Kurven etc.

Digitale Signatur:

* Bieten IntegritÃ¤t von Dokumenten (i.e. dass die Dokumente unverÃ¤ndert sind)
* Bieten AuthentizitÃ¤t (i.e. der Ursprung kann bewiesen werten, z.B. wenn das Dokument von Person X signiert, muss diese Person den privaten SchlÃ¼ssel haben)
* sind effizient erstellt und verifiziert

Ãœbung 1

|                 | Public Key          | Private Key        |
| --------------- | ------------------- | ------------------ |
| AuthentizitÃ¤t   | Signatur Ã¼berprÃ¼fen | Signatur erstellen |
| Vertraulichkeit | VerschlÃ¼sseln       | EntschlÃ¼sseln      |

Ãœbung 2

|            | Sender has...        | Recipient has...      |
| ---------- | -------------------- | --------------------- |
| Signing    | Sender Private Key   | Sender Public Key     |
| Encrypting | Recipient Public Key | Recipient Private Key |



## Signieren & VerschlÃ¼sseln (Beispiel an E-Mail)

ğŸ¯ Sie wissen, wann Ã¶ffentliche und wann private SchlÃ¼ssel beim Einsatz von PKI-Verfahren zur Anwendung gelangen

ğŸ¯ Sie wissen, worauf beim Beantragen von Zertifikaten zu achten ist



- Session Key wird nur fÃ¼r diese E-Mail angewendet und verschlÃ¼sselt die Meldung symmetrisch
- wird zufÃ¤llig generiert und asymmetrisch verschlÃ¼sselt (mit Public Key des EmpfÃ¤ngers)
- => hybrid weil symmetrische Algorithmen schneller (weil Dokumente gross sind) und asymmetrische, langsame Algos mÃ¼ssen nur den SchlÃ¼ssel verschlÃ¼sseln (z.B. 256 bit). 
- Man nimmt die Vorteile der SchlÃ¼sselverteilung der asymmetrische Krypto mit der Performance der symmetrischen Verfahren.
- Der SchlÃ¼ssel muss **vertraulich** verteilt werden => das geht bei asymm. Krypto einfacher, sonst wirds aufwÃ¤ndig.



TODO: Wie mÃ¼ssen die SchlÃ¼ssel verteilt werden? 



Von links nach rechts (Folie 15):

* unten: Session Key mit privaten SchlÃ¼ssel entschlÃ¼sseln => Session Key
* Dokument mit Session Key entschlÃ¼sseln
* Signatur Ã¼berprÃ¼fen mit Public Key des Absenders



VerschlÃ¼sselung & Signieren: Es wird zuerst signiert, dann verschlÃ¼sselt da die Signatur die AuthentizitÃ¤t des Plaintextes beweisen soll. Diese AuthentizitÃ¤t soll durch die EntschlÃ¼sselung nicht verloren gehen, daher wird sie vor der VerschlÃ¼sselung angewendet.





## Sicherheitsanforderungen an private und Ã¶ffentliche SchlÃ¼ssel

ğŸ¯ Sie wissen, wie Zertifikate erzeugt werden

ğŸ¯ Sie kennen die wichtigsten Key-Management-Aspekte beim Umgang mit Ã¶ffentlichen und privaten SchlÃ¼sseln

**Certificate Authority (CA)**

> VertrauenswÃ¼rdige Institution, die Ã¶ffentliche SchlÃ¼ssel beglaubigt und publiziert

* Ordnet Ã¶ffentliche SchlÃ¼ssel einer Person zu
* VerÃ¶ffentlicht diesen Ã¶ffentlichen SchlÃ¼ssel & macht ihn dadurch allen Personen zugÃ¤nglich
* Zertifikat: "Digitale" Beglaubigung des Ã¶ffentlichen SchlÃ¼ssels wird als *Zertifikat* bezeichnet
* (Zertifikate kÃ¶nnen und werden auch fÃ¼r Computer ausgestellt, z.B. Zertifikate fÃ¼r TLS)



**Ã–ffentliche SchlÃ¼ssel mÃ¼ssen:**

* beglaubigt sein (i.e. eindeutig einer Person oder Computer zugeordnet werden) -> SchlÃ¼ssel wird in ein Zertifikat embedded
  ![image-20201125214119606](assets/image-20201125214119606.png)

Ist dies nicht gegeben, kÃ¶nnen Angreifende welche man in the middle access haben einfach einen anderen Public Key vorgaukeln und dann die Nachricht abfangen und entschlÃ¼sseln (aktiver Angriff). Um keinen Verdacht zu erwecken kÃ¶nnen sie danach die Nachricht noch immer mit dem richtigen Public Key verschlÃ¼sseln und versenden.

![image-20201125214320899](assets/image-20201125214320899.png)



**Private SchlÃ¼ssel**

* mÃ¼ssen sicher aufbewahrt werden (i.e. nur die besitzende Person darf darauf zugreifen)
* beispiele dafÃ¼r sind Smart-Cards oder Hardware-Keys

## Zertifikate und ihr Lebenszyklus

Zertifikat erstellen:

1. Antragstellende Person wird durch CA verifiziert (z.B. mittels ID, Pass oÃ„)
2. Zertifikatsinhalt (Name, Public Key, weitere Info) erstellen
3. Zertifikatsinhalt wird mit dem Private Key der CA signiert -> Resultat: Zertifikat
4. CA verÃ¶ffentlicht dieses Zertifikat



Zertifikate haben ein GÃ¼ltigkeitsdatum, danach werden sie ungÃ¼ltig.



**Zertifikatsklassen**

Macht Vorgaben fÃ¼r verschiedene Faktoren:

* Registrierungsprozess
* Was im Zertifikat steht (z.B. Name)
* Zu verwendende Token
* Wer darf so ein Zertifikat erhalten (Inhabende Person)
* Anforderungen an die CA

Die Namen der Klassen variieren bei den Zertifizierungsstellen.

**Class 1 Certificates (tiefe Sicherheit)**

- ÃœberprÃ¼ft die IdentitÃ¤t der Antragsstellenden nicht
- Stellen nur sicher, dass der Name im Zertifikat einmalig ist
- Werden idR online bestellt und sind oft gratis
- Beispiele:
  - Freemail-Certificates: ÃœberprÃ¼fung der IdentitÃ¤t erfolgt Ã¼ber z.B. eine Validierungsemail (so kann man sicherstellen, dass der Antragsstellende die E-Mail Adresse besitzt)
  - Lets Encrypt: Dasselbe Konzept -> prÃ¼ft einfach ob Antragsstellende die Domain besitzt

**Class 2 Certificates (mittlere Sicherheit)**



**Class 3 Certificates (hohe Sicherheit)**

**Extended Validation Certificates (hÃ¶hchste Sicherheit)**



**Certificate Revocation (UngÃ¼ltigkeitserklÃ¤rung)**

* GrÃ¼nde: Privater SchlÃ¼ssel wurde gebrochen / kam abhanden, Zertifikatsbesitzer verlÃ¤sst das Unternehmen, Personendaten des Zertifikatsbesitzer haben sich geÃ¤ndert ...s
* Zertifikate werden Ã¼ber die Seriennummer identifiziert
* Revozierte Certs wird auf der Certificate Revocation List (CRL) pro CA gefÃ¼hrt, die CA muss diese Liste publizieren
* Alternative dazu ist auch eine Online-PrÃ¼fung via Online Certificate Status Protocol (OCSP)



## Bausteine einer PKI

> ğŸ¯ Sie wissen, aus welchen Komponenten eine PKI aufgebaut ist und welche Aufgaben diese haben

**Certification Authority (CA)**



**Personal Security Environment (PSE)**



**Directory Service**

Ist Ablageort der ausgestellten Zertifikate und der ausgestellten CRL â€¢ Wird von der Sicherheitsapplikation angesprochen â€¢ Kommuniziert zum Zwecke des Datenabgleichs evtl. mit anderen Verzeichnisdiensten â€¢ Lagert nicht nur Zertifikate und CRLs, sondern auch andere Personendaten. Bsp. Globales Adressbuch von Microsoft Exchange



**Sicherheitsapplikation**





## GÃ¼ltigkeit von Zertifikaten & Zertifikatsketten

>  ğŸ¯ Sie wissen, wie Zertifikate Ã¼berprÃ¼ft werden und welche Rolle dabei Zertifikatsketten spielen